#!/usr/bin/env sh
#新しい環境に取り込んだ時のインストール

DIR=$(cd `dirname $0`; pwd)

# if [ -e /usr/bin/zsh ]; then
# 	chsh /usr/bin/zsh
# fi 

if [ ! -e `which git` ]; then
    echo 'not found git'
fi 

if [ ! -e `which vim` ]; then
    echo 'not found vim.'
    echo 'Start installing ...'
    $DIR/scripts/vim-install.sh
fi 

echo "$DIR/vimfiles => ~/.vim"
ln -s $DIR/vimfiles ~/.vim

for dotfile in $DIR/.* ; do
    if [ $dotfile = ${DIR}/.git ]; then
        continue
    fi
    if [ $dotfile = '.' ]; then
        continue
    fi
    if [ $dotfile = '..' ]; then
        continue
    fi

    dstpath="$HOME/${dotfile##*/}" 
    if [ -L $dstpath ]; then
        rm $dstpath
        echo "remove $dstpath"
    fi 
    echo "$dotfile => $dstpath" 
    ln -s $dotfile ~/ 
done

for dotfile in $DIR/local_template/.* ; do
    file_name="${dotfile##*/}" 
    if [ $file_name = ${DIR}/local_template/.git ]; then
        continue
    fi
    if [ $file_name = '.' ]; then
        continue
    fi
    if [ $file_name = '..' ]; then
        continue
    fi

    dstpath="$HOME/.local$file_name"
    if ! [ -L $dstpath ]; then
        echo "Already exists: ${dstpath}"
    else
        echo "$dotfile => $dstpath" 
        ln -s -T $dotfile $dstpath
    fi 
done
 

git submodule init
git submodule update
